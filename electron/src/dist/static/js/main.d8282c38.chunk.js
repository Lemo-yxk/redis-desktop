(this["webpackJsonpredis-web"]=this["webpackJsonpredis-web"]||[]).push([[0],{302:function(e,t,a){e.exports=a(648)},325:function(e,t,a){},326:function(e,t,a){},327:function(e,t,a){},329:function(e,t,a){},347:function(e,t,a){},409:function(e,t,a){},569:function(e,t,a){},572:function(e,t,a){},573:function(e,t,a){},601:function(e,t,a){},602:function(e,t,a){},603:function(e,t,a){},616:function(e,t,a){},617:function(e,t,a){},643:function(e,t,a){},644:function(e,t,a){},645:function(e,t,a){},648:function(e,t,a){"use strict";a.r(t);a(102);var n=a(35),r=(a(54),a(16)),s=a(0),i=a.n(s),c=a(14),l=a.n(c),o=a(37),u=a.n(o),h=(a(325),a(12)),d=a(19),p=a(17),f=a(11),v=a(20),m=a(297),y=a(78),k=a(42),g=(a(326),a(327),a(39),a(5)),b=(a(329),new(function(){function e(){Object(h.a)(this,e),this.events={}}return Object(f.a)(e,[{key:"add",value:function(e,t){return this.events[e]=t,e}},{key:"remove",value:function(e){delete this.events[e]}},{key:"emit",value:function(e){for(var t,a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];this.events[e]&&(t=this.events)[e].apply(t,n)}}]),e}())),x=a(649),w=a(650),E=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={date:""},a.addKey=function(){b.emit("addKey")},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"header"},i.a.createElement("div",{className:"left"},i.a.createElement(g.a,{type:"link",ghost:!0,onClick:this.addKey},i.a.createElement(x.a,null))),i.a.createElement("div",{className:"right"},i.a.createElement(g.a,{type:"primary",onClick:function(){return b.emit("openAddServer")}},"\u6dfb\u52a0\u670d\u52a1\u5668"),i.a.createElement(g.a,{type:"dashed",danger:!0,ghost:!0,onClick:function(){return b.emit("openServerList")}},i.a.createElement(w.a,null))))}}]),t}(s.Component),C=a(3),S=a.n(C),O=a(10),N=(a(223),a(150)),j=(a(68),a(13)),I=(a(167),a(36)),R=(a(347),new(function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"getCurrent",value:function(){return JSON.parse(localStorage.getItem("current")||"{}")}},{key:"setCurrent",value:function(e){localStorage.setItem("current",JSON.stringify(e))}},{key:"delCurrent",value:function(){localStorage.removeItem("current")}},{key:"setServerName",value:function(e){localStorage.setItem("serverName",e)}},{key:"getServerName",value:function(){return localStorage.getItem("serverName")}},{key:"delServerName",value:function(){localStorage.removeItem("serverName")}},{key:"setDB",value:function(e){localStorage.setItem("db","".concat(e))}},{key:"getDB",value:function(){var e=localStorage.getItem("db");return e?parseInt(e):null}},{key:"delDB",value:function(){localStorage.removeItem("db")}},{key:"setStatus",value:function(e){localStorage.setItem("status",e)}},{key:"getStatus",value:function(){return localStorage.getItem("status")}},{key:"delStatus",value:function(){localStorage.removeItem("status")}},{key:"createUUID",value:function(){localStorage.setItem("uuid",Math.random().toString(16).slice(2))}},{key:"getUUID",value:function(){return localStorage.getItem("uuid")}},{key:"allConfig",value:function(){return JSON.parse(localStorage.getItem("config")||"{}")}},{key:"getConfig",value:function(e){return JSON.parse(localStorage.getItem("config")||"{}")[e]}},{key:"setConfig",value:function(e,t){var a=JSON.parse(localStorage.getItem("config")||"{}");a[e]=t,localStorage.setItem("config",JSON.stringify(a))}},{key:"deleteConfig",value:function(e){var t=JSON.parse(localStorage.getItem("config")||"{}");delete t[e],localStorage.setItem("config",JSON.stringify(t))}},{key:"deleteAllConfig",value:function(){localStorage.removeItem("config")}},{key:"clear",value:function(){localStorage.clear()}}]),e}())),T=a(80),K=a(79),D=a.n(K),V=new(function(){function e(){Object(h.a)(this,e),this.mask=void 0;var t=document.createElement("div");t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.width="100vw",t.style.height="100vh",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.display="none",this.mask=t;var a=document.createElement("div");a.className="load-mask-child",t.appendChild(a),document.body.appendChild(t)}return Object(f.a)(e,[{key:"load",value:function(){this.mask.style.display="flex"}},{key:"close",value:function(){this.mask.style.display="none"}}]),e}()),A=new(function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"QueryString",value:function(e){var t="";for(var a in e)t+="".concat(a,"=").concat(e[a],"&");return t.slice(0,-1)}},{key:"Range",value:function(e,t){for(var a=[],n=e;n<t;n++)a.push(n);return a}},{key:"Notification",value:function(e,t,a){if(e.isAxiosError){var s=e.toJSON();throw console.log(s),n.a.error({message:s.message}),r.a.destroy(),V.close(),s}return t=t||e.data.msg,a=a||e.data.msg,200===e.data.code?(console.log(e.data),n.a.success({message:t}),!0):(n.a.error({message:a}),!1)}},{key:"IsFloat",value:function(e){return!!/^[0-9]+\.?[0-9]*$/.test(e)}}]),e}()),B=new(function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"serverNameAndDB",value:function(){var e=R.getServerName(),t=R.getDB();return null===e?n.a.error({message:"\u8bf7\u8fde\u63a5\u670d\u52a1!"}):null===t?n.a.error({message:"\u8bf7\u9009\u62e9DB!"}):{name:e,db:t}}},{key:"uuid",value:function(){var e=R.getUUID();return e?{uuid:e}:n.a.error({message:"uuid is empty!"})}},{key:"export",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u()({url:"".concat(u.a.defaults.baseURL,"/redis/export/file?fileName=").concat(t,"&data=").concat(a),method:"GET",responseType:"blob"}).then((function(e){var a=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",t),document.body.appendChild(n),n.click()})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/register/".concat(t),D.a.stringify(Object(T.a)({},this.uuid(),{},a)));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(O.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/db/disconnect",D.a.stringify(Object(T.a)({name:t},this.uuid())));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"selectDB",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/db/select",D.a.stringify(Object(T.a)({name:t,db:a},this.uuid())));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"scan",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/db/scan",D.a.stringify(Object(T.a)({},this.serverNameAndDB(),{},this.uuid())));case 2:return t=e.sent,e.abrupt("return",t.data.msg);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"type",value:function(){var e=Object(O.a)(S.a.mark((function e(t){var a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/key/type",D.a.stringify(Object(T.a)({},this.serverNameAndDB(),{key:t},this.uuid())));case 2:return a=e.sent,e.abrupt("return",a.data.msg);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"do",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/key/do",D.a.stringify(Object(T.a)({},this.serverNameAndDB(),{},this.uuid(),{key:t,args:JSON.stringify(a)})));case 2:if(200===(n=e.sent).data.code){e.next=5;break}return e.abrupt("return",A.Notification(n));case 5:return e.abrupt("return",n.data.msg);case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"doPipe",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("/redis/key/do",D.a.stringify(Object(T.a)({},this.serverNameAndDB(),{},this.uuid(),{key:t,args:JSON.stringify(a)})));case 2:if(200===(n=e.sent).data.code){e.next=5;break}return e.abrupt("return",A.Notification(n));case 5:return e.abrupt("return",n.data.msg);case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}()),z=a(651),U=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,connectType:"normal",clusterHostInput:null},a.event=void 0,a.name="",a.host="",a.port="",a.password="",a.master="",a.cluster=[],a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"onClose",value:function(){this.setState({visible:!1,clusterHostInput:null})}},{key:"onOpen",value:function(){this.setState({visible:!0})}},{key:"componentDidMount",value:function(){var e=this;this.event=b.add("openAddServer",(function(){return e.onOpen()}))}},{key:"componentWillUnmount",value:function(){b.remove(this.event)}},{key:"render",value:function(){var e=this;return i.a.createElement(N.a,{title:"\u6dfb\u52a0\u670d\u52a1\u5668",placement:"right",closable:!1,onClose:function(){return e.onClose()},visible:this.state.visible,getContainer:!1,width:"400px",destroyOnClose:!0,className:"add-server"},i.a.createElement(I.a.Group,{value:this.state.connectType,onChange:function(t){return e.setState({connectType:t.target.value})}},i.a.createElement(I.a.Button,{value:"normal"},"Default"),i.a.createElement(I.a.Button,{value:"cluster"},"Cluster")),i.a.createElement("div",{className:"normal-form"},i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Name",placeholder:"127.0.0.1",onChange:function(t){return e.name=t.target.value}}),"normal"===this.state.connectType?i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Host",placeholder:"127.0.0.1",onChange:function(t){return e.host=t.target.value}}):i.a.createElement("div",{className:"add-input-box"},i.a.createElement("div",{className:"add"},i.a.createElement(g.a,{type:"dashed",onClick:function(){return e.addHost()}},"HOST")),i.a.createElement("div",{className:"input"},this.state.clusterHostInput)),"normal"===this.state.connectType?i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Port",placeholder:"6379",onChange:function(t){return e.port=t.target.value}}):i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Master",placeholder:"master",onChange:function(t){return e.master=t.target.value}}),i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Pass",placeholder:"password",onChange:function(t){return e.password=t.target.value}}),i.a.createElement("div",{className:"button-box"},i.a.createElement(g.a,{type:"primary",onClick:function(){return e.submit()}},"\u521b\u5efa"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.test()}},"\u6d4b\u8bd5"))))}},{key:"createCluster",value:function(){var e=this;return this.cluster.map((function(t,a){return i.a.createElement(j.a,{spellCheck:!1,key:a,addonAfter:i.a.createElement(z.a,{onClick:function(){return e.removeHost(a)}}),className:"package-input",placeholder:"127.0.0.1:16379",onChange:function(t){e.cluster[a]=t.target.value}})}))}},{key:"removeHost",value:function(e){this.cluster.splice(e,1),this.setState({clusterHostInput:this.createCluster()})}},{key:"addHost",value:function(){this.cluster.push(""),this.setState({clusterHostInput:this.createCluster()})}},{key:"test",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={name:this.name,host:this.host,port:this.port,password:this.password,master:this.master,cluster:this.cluster.filter((function(e){return""!==e})),connectType:this.state.connectType,default:!1},e.next=3,B.register(this.state.connectType,t);case 3:return a=e.sent,e.abrupt("return",A.Notification(a,"\u8fde\u63a5\u6210\u529f"));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={name:this.name,host:this.host,port:this.port,password:this.password,master:this.master,connectType:this.state.connectType,cluster:this.cluster.filter((function(e){return""!==e})),default:!1},""!==this.name){e.next=3;break}return e.abrupt("return",n.a.error({message:"\u670d\u52a1\u5668\u540d\u4e0d\u80fd\u4e3a\u7a7a!"}));case 3:if(!R.getConfig(this.name)){e.next=6;break}return e.abrupt("return",n.a.error({message:"ERROR",description:"".concat(this.name," \u5df2\u7ecf\u5b58\u5728!")}));case 6:return R.setConfig(this.name,t),this.onClose(),b.emit("addServer",this.name),e.abrupt("return",n.a.success({message:"SUCCESS",description:"\u521b\u5efa\u6210\u529f"}));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(s.Component),P=(a(99),a(33)),H=a(283),L=(a(409),a(286)),J=a.n(L),M=new(function(){function e(){var t=this;Object(h.a)(this,e),this.ws=void 0,this.isStart=!1,this.ws=new J.a({host:"http://127.0.0.1",port:"12389"}),this.ws.Global={uuid:R.getUUID()},this.ws.OnOpen=function(){console.log("on open"),t.ws.Emit("/redis/login/login",{})},this.ws.AddListener("/redis/login/login",(function(e,t){R.setStatus("ready"),window.location.hash="#/index"})),this.ws.OnError=function(e){console.log("on error",e)},this.ws.OnClose=function(){R.delStatus(),window.location.hash="#/login",console.log("on close")}}return Object(f.a)(e,[{key:"start",value:function(e){!this.isStart&&this.ws.Start(e),this.isStart=!0}},{key:"close",value:function(){this.isStart&&this.ws.Close(),this.isStart=!1}},{key:"listen",value:function(){var e;(e=this.ws).AddListener.apply(e,arguments)}},{key:"remove",value:function(){var e;(e=this.ws).RemoveListener.apply(e,arguments)}}]),e}()),G=a(287),W=new(function(){function e(){Object(h.a)(this,e),this.dataTree=[],this.counter=0}return Object(f.a)(e,[{key:"clear",value:function(){this.dataTree=[],this.counter=0}},{key:"checkRead",value:function(e){var t=[];return function e(a){for(var n=0;n<a.length;n++)a[n].children?e(a[n].children):a[n].read?a[n].read=!1:t.push(a[n])}(e),t}},{key:"search",value:function(e,t){for(var a=0;a<e.length;a++)if(e[a].children){var n=this.search(e[a].children,t);if(n)return n}else if(e[a].prefix===t)return e[a];return null}},{key:"deleteNode",value:function(e){if(e.parent){var t=e.parent.children.findIndex((function(t){return t.id===e.id}));e.parent.children.splice(t,1),0===e.parent.children.length&&this.deleteNode(e.parent)}else{var a=this.dataTree.findIndex((function(t){return t.id===e.id}));this.dataTree.splice(a,1)}}},{key:"deleteKey",value:function(e){var t=this.search(this.dataTree,e);t&&(this.countSub(t),this.deleteNode(t))}},{key:"inArr",value:function(e,t){for(var a=0;a<e.length;a++)if(e[a].i===t&&e[a].children)return e[a];return!1}},{key:"inArr1",value:function(e,t){for(var a=0;a<e.length;a++)if(e[a].i===t&&!e[a].children)return{parent:e,current:e[a]};return!1}},{key:"addKey",value:function(e,t,a,n){for(var r=e.split(":"),s=this.dataTree,i=null,c=0;c<r.length;c++){if(1===r.length){var l=this.inArr1(s,r[c]);if(l)return void(l.current.read=!0)}if(1!==r.length){var o=this.inArr(s,r[c]);if(o&&c!==r.length-1){i=o,s=o.children;continue}if(c===r.length-1)for(var u=0;u<s.length;u++)if(s[u].name===e)return void(s[u].read=!0)}var h={id:this.counter++,name:c===r.length-1?e:r[c],isKey:c===r.length-1,i:r[c],prefix:r.slice(0,c+1).join(":"),children:c===r.length-1?null:[],read:t,count:0,parent:i,toggled:n,active:a};c===r.length-1&&this.countAdd(h),i=h,s.push(h),s=h.children}}},{key:"countAdd",value:function(e){e.parent&&(e.parent.count++,e.parent.name="".concat(e.parent.i," (").concat(e.parent.count,")"),this.countAdd(e.parent))}},{key:"countSub",value:function(e){e.parent&&(e.parent.count--,e.parent.name="".concat(e.parent.i," (").concat(e.parent.count,")"),this.countSub(e.parent))}}]),e}()),Z=P.a.Option,Y=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={databases:[],dataTree:[],db:"\u8bf7\u9009\u62e9DB"},a.serverName="",a.connectType="",a.dbSize=0,a.selectedNode=null,a.shouldRefresh=!1,a.style={tree:{base:{fontSize:"12px",whiteSpace:"pre-wrap",backgroundColor:"#ffffff",height:"100%",padding:"5px"},node:{base:{color:"red"},activeLink:{backgroundColor:"#bae7ff"}}}},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"updateTree",value:function(){this.setState({dataTree:W.dataTree})}},{key:"updateDatabases",value:function(){for(var e=this.state.databases,t=0;t<e.length;t++)e[t].key===this.state.db&&(e[t].size=this.dbSize);this.setState({databases:e})}},{key:"componentDidMount",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.add("connect",(function(e,a,n){return t.connect(e,a,n)})),b.add("selectDB",(function(e,a){return t.selectDB(e,a)})),b.add("disconnect",(function(e){return t.disconnect(e)})),b.add("update",(function(e){return t.update(e)})),b.add("delete",(function(e){return t.delete(e)})),b.add("deleteKey",(function(e,a){return t.deleteKey(e,a)})),b.add("insertKey",(function(e,a,n){return t.insertKey(e,a,n)})),b.add("activeKey",(function(e,a){return t.activeKey(e,a)})),M.listen("scan",(function(e,a){var n=a.keys||[];b.emit("progress",a.current/a.dbSize*100);for(var r=0;r<n.length;r++)W.addKey(n[r],t.shouldRefresh);t.dbSize=a.dbSize,a.dbSize===a.current&&(b.emit("progress",0),t.readDone()),t.updateTree(),t.updateDatabases()})),this.connectDefault();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connectDefault",value:function(){var e=R.allConfig();for(var t in e){var a=e[t];if(a.default){b.emit("connect",a.name,a.connectType,(function(){b.emit("selectDB",0)}));break}}}},{key:"activeKey",value:function(e,t){var a=W.search(W.dataTree,e);if(a){if(this.selectedNode.active=!1,this.selectedNode=a,this.selectedNode.active=t,t)for(var n=a;n.parent;)n.parent.toggled=!0,n=n.parent;this.updateTree()}}},{key:"deleteKey",value:function(e,t){W.deleteKey(e),this.dbSize--,t&&t(),this.updateDatabases(),this.updateTree()}},{key:"insertKey",value:function(e,t,a){W.addKey(e,this.shouldRefresh,t),this.dbSize++,a&&a(),this.updateDatabases(),this.updateTree()}},{key:"readDone",value:function(){if(r.a.info("\u6570\u636e\u52a0\u8f7d\u6210\u529f"),this.shouldRefresh)for(var e=W.checkRead(W.dataTree),t=0;t<e.length;t++)W.deleteKey(e[t].name);this.shouldRefresh=!1,V.close()}},{key:"componentWillUnmount",value:function(){b.remove("connect"),b.remove("selectDB"),b.remove("disconnect"),b.remove("update"),b.remove("delete"),b.remove("deleteKey"),b.remove("insertKey"),b.remove("activeKey"),M.remove("scan"),W.clear()}},{key:"connect",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a,n){var s,i;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.serverName!==t){e.next=2;break}return e.abrupt("return");case 2:return this.reset(),this.connectType=a,this.serverName=t,e.next=7,this.login();case 7:if(s=e.sent){e.next=10;break}return e.abrupt("return");case 10:for(R.setServerName(t),i=0;i<parseInt(s);i++)this.state.databases.push({title:"db-".concat(i),key:i,size:0});r.a.success("\u8fde\u63a5\u6210\u529f"),R.setCurrent(R.getConfig(t)),this.updateDatabases(),n&&n();case 16:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"reset",value:function(){W.clear(),this.serverName="",this.connectType="",this.dbSize=0,this.selectedNode=null,this.shouldRefresh=!1,this.setState({databases:[],dataTree:[],db:"\u8bf7\u9009\u62e9DB"}),R.delDB(),R.delServerName(),R.delCurrent(),b.emit("resetPanel")}},{key:"disconnect",value:function(e){this.serverName===e&&this.reset()}},{key:"update",value:function(e){b.emit("openUpdateServer",e)}},{key:"delete",value:function(e){this.serverName===e&&this.reset()}},{key:"render",value:function(){var e=this;return i.a.createElement(H.a,{default:{height:"100%",width:"250px",x:0,y:0},minWidth:250,maxWidth:500,bounds:".content",enableResizing:{right:!0},disableDragging:!0,className:"key-tree"},i.a.createElement("div",{className:"select-panel"},this.state.databases.length>0?i.a.createElement(P.a,{value:this.state.db,style:{width:"100%"},listHeight:600,onSelect:function(t){return e.selectDB(t)}},this.state.databases.map((function(e){return i.a.createElement(Z,{key:e.key,value:e.key},e.title," ",e.size?"(".concat(e.size,")"):"")}))):null),i.a.createElement("div",{className:"data-tree"},this.state.dataTree.length>0?i.a.createElement(G.Treebeard,{data:this.state.dataTree,onToggle:function(t,a){return e.onToggle(t,a)},style:this.style,animations:!1}):null),i.a.createElement("div",{className:"title"},this.state.dataTree.length>0?i.a.createElement("div",null,i.a.createElement("div",null,this.serverName," ",this.connectType),i.a.createElement(g.a,{type:"link",danger:!0,onClick:function(){return e.refresh()}},"\u5237\u65b0")):null))}},{key:"refresh",value:function(){this.shouldRefresh=!0,this.selectDB(this.state.db)}},{key:"onToggle",value:function(e,t){this.selectedNode&&(this.selectedNode.active=!1),this.selectedNode=e,this.selectedNode.active=!0,this.selectedNode.children?this.selectedNode.toggled=t:this.onSelect(e.name),this.updateTree()}},{key:"onSelect",value:function(){var e=Object(O.a)(S.a.mark((function e(t){var a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.type(t);case 2:a=e.sent,b.emit("selectKey",this.serverName,a,t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V.load(),t=R.getConfig(this.serverName),e.next=4,B.register(this.connectType,t);case 4:if(a=e.sent,V.close(),200===a.data.code){e.next=9;break}return A.Notification(a),e.abrupt("return",!1);case 9:return e.abrupt("return",a.data.msg[1]);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"selectDB",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.db!==t&&W.clear(),V.load(),this.state.db=t,e.next=5,B.selectDB(this.serverName,t);case 5:if(200===(n=e.sent).data.code){e.next=8;break}return e.abrupt("return",A.Notification(n));case 8:return R.setDB(t),e.next=11,B.scan();case 11:a&&a();case 12:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),t}(s.Component),F=(a(567),a(209)),X=(a(569),a(100),a(26)),$=(a(87),a(29)),Q=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"check",value:function(e){switch(e){case"string":return new q;case"list":return new _;case"hash":return new ee;case"set":return new te;case"zset":return new ae;default:return n.a.error({message:"Unsupported type ".concat(e)}),new ne}}},{key:"select",value:function(e,t){for(var a,n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];return this.do(t,(a=this.check(e)).select.apply(a,[t].concat(r)))}},{key:"update",value:function(e,t,a){for(var n,r=arguments.length,s=new Array(r>3?r-3:0),i=3;i<r;i++)s[i-3]=arguments[i];return this.do(t,(n=this.check(e)).update.apply(n,[t,a].concat(s)))}},{key:"insert",value:function(e,t,a){for(var n,r=arguments.length,s=new Array(r>3?r-3:0),i=3;i<r;i++)s[i-3]=arguments[i];return this.do(t,(n=this.check(e)).insert.apply(n,[t,a].concat(s)))}},{key:"delete",value:function(e,t){for(var a,n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];return this.do(t,(a=this.check(e)).delete.apply(a,[t].concat(r)))}},{key:"call",value:function(e,t,a){for(var n,r=arguments.length,s=new Array(r>3?r-3:0),i=3;i<r;i++)s[i-3]=arguments[i];return this.do(t,(n=this.check(e))[a].apply(n,[t].concat(s)))}},{key:"ttl",value:function(e){return this.do(e,["TTL",e])}},{key:"rename",value:function(e,t){return this.do(e,["RENAME",e,t])}},{key:"expire",value:function(e,t){return this.do(e,["EXPIRE",e,t])}},{key:"doPipe",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.doPipe(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"do",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.do(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),q=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"select",value:function(e){return["GET",e]}},{key:"update",value:function(e,t){return["SET",e,t]}},{key:"insert",value:function(e,t){return["SET",e,t]}},{key:"delete",value:function(e){return["DEL",e]}}]),e}(),_=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"len",value:function(e){return["LLEN",e]}},{key:"insert",value:function(e,t){return["LPUSH",e,t]}},{key:"select",value:function(e,t,a){return["LRANGE",e,(t-1)*a,a*t-1]}},{key:"update",value:function(e,t,a){return["LSET",e,t,a]}},{key:"delete",value:function(e,t){return["LREM",e,0,t]}},{key:"remove",value:function(e){return["DEL",e]}}]),e}(),ee=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"select",value:function(e,t){return["HSCAN",e,t,"COUNT",1e4]}},{key:"len",value:function(e){return["HLEN",e]}},{key:"update",value:function(e,t,a){return["HSET",e,t,a]}},{key:"insert",value:function(e,t,a){return["HSET",e,t,a]}},{key:"delete",value:function(e,t){return["HDEL",e,t]}},{key:"remove",value:function(e){return["DEL",e]}}]),e}(),te=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"len",value:function(e){return["SCARD",e]}},{key:"insert",value:function(e,t){return["SADD",e,t]}},{key:"select",value:function(e,t){return["SSCAN",e,t,"COUNT",1e4]}},{key:"update",value:function(e,t){return["SADD",e,t]}},{key:"delete",value:function(e,t){return["SREM",e,t]}},{key:"remove",value:function(e){return["DEL",e]}}]),e}(),ae=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"len",value:function(e){return["ZCARD",e]}},{key:"insert",value:function(e,t,a){return["ZADD",e,t,a]}},{key:"select",value:function(e,t,a){return["ZRANGE",e,(t-1)*a,a*t-1,"WITHSCORES"]}},{key:"update",value:function(e,t,a){return["ZADD",e,t,a]}},{key:"delete",value:function(e,t){return["ZREM",e,t]}},{key:"remove",value:function(e){return["DEL",e]}}]),e}(),ne=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"select",value:function(){}}]),e}(),re=new Q,se=(a(572),a(652)),ie=j.a.TextArea,ce=P.a.Option,le=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).parent=void 0,a.state={key:"",showValue:"",rename:!1,view:"\u663e\u793a\u683c\u5f0f"},a.type="",a.key="",a.ttl=-1,a.type=a.props.type,a.key=a.props.keys,a.parent=a.props.parent,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.select(this.type,this.key)}},{key:"componentWillUnmount",value:function(){}},{key:"select",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.type=t,this.key=a,e.next=4,re.select(t,a);case 4:return n=e.sent,e.next=7,re.ttl(a);case 7:r=e.sent,this.ttl=r,this.setState({key:a,showValue:n});case 10:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"string"},i.a.createElement($.a,{visible:this.state.rename,maskClosable:!1,closable:!1,onOk:function(){return e.renameKey()},onCancel:function(){return e.closeRename()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{addonBefore:this.type.toUpperCase(),addonAfter:"TTL: ".concat(this.ttl),value:this.state.key,spellCheck:!1}),i.a.createElement(g.a,{type:"default",onClick:function(){return e.openRename()}},"\u91cd\u547d\u540d"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.select(e.type,e.state.key)}},"\u5237\u65b0"),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.key," \u5417?"),onConfirm:function(){return e.deleteKey()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"dashed",danger:!0},"\u5220\u9664"))),i.a.createElement("div",{className:"bottom"},i.a.createElement(P.a,{value:this.state.view,style:{width:100},onSelect:function(t){return e.changeView(t)}},i.a.createElement(ce,{key:"plain/text",value:"plain/text"},"plain/text"),i.a.createElement(ce,{key:"json",value:"json"},"json")))),i.a.createElement("div",{className:"content"},i.a.createElement(ie,{spellCheck:!1,value:this.state.showValue,onChange:function(t){return e.onChange(t.target.value)}})),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"top"},i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u4fdd\u5b58\u5417?",onConfirm:function(){return e.save()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"primary"},"\u4fdd\u5b58"))),i.a.createElement("div",{className:"bottom"})))}},{key:"save",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.update(this.type,this.key,this.state.showValue);case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:r.a.success("\u4fdd\u5b58\u6210\u529f");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeView",value:function(e){switch(e){case"json":try{var t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t,null,4)})}catch(a){return}break;case"text":try{t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t)})}catch(a){return}}}},{key:"deleteKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.delete(this.type,this.state.key);case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:b.emit("deleteKey",this.key),this.parent.remove(this.key);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.key,a=this.state.key,this.key=this.state.key,e.next=5,re.rename(t,a);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",this.closeRename());case 8:b.emit("insertKey",a,!0),b.emit("deleteKey",t),this.closeRename(),this.parent.update(this.type,t,a);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeRename",value:function(){this.setState({rename:!1})}},{key:"openRename",value:function(){this.setState({rename:!0})}},{key:"onChange",value:function(e){this.setState({showValue:e})}}]),t}(s.Component),oe=(a(573),a(653)),ue=a(654),he=a(47),de=j.a.TextArea,pe=P.a.Option,fe=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).parent=void 0,a.state={key:"",showValue:"",list:[],page:1,rename:!1,addRow:!1,addRowValue:"",view:"\u663e\u793a\u683c\u5f0f"},a.type="",a.key="",a.ttl=-1,a.size=1e3,a.len=0,a.selectIndex=0,a.page=1,a.listIndex=0,a.vlist=i.a.createRef(),a.onScroll=function(e){},a.renderItem=function(e){if(!(e.index>a.state.list.length-1))return a.state.list[e.index].select&&(e.style=Object.assign({background:"rgb(186, 231, 225)"},e.style)),i.a.createElement("div",{key:e.index,style:e.style,className:"list-item",onClick:function(t){return a.selectItem(t,e)}},i.a.createElement("div",{className:"key"},(a.page-1)*a.size+e.index+1),i.a.createElement("div",{className:"value"},a.state.list[e.index].value))},a.prevPage=function(){a.state.page<=1||!a.state.page||(a.state.page--,a.setPage(a.state.page),a.go())},a.nextPage=function(){a.state.page>=Math.ceil(a.len/a.size)||!a.state.page||(a.state.page++,a.setPage(a.state.page),a.go())},a.go=function(){a.select(a.type,a.key)},a.type=a.props.type,a.key=a.props.keys,a.parent=a.props.parent,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.select(this.type,this.key)}},{key:"componentWillUnmount",value:function(){}},{key:"select",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r,s,i,c,l=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.type=t,this.key=a,e.next=4,re.call(t,a,"len");case 4:return n=e.sent,this.len=n,e.next=8,re.ttl(a);case 8:return r=e.sent,this.ttl=r,this.page=this.state.page,e.next=13,re.select(t,a,this.state.page,this.size);case 13:if(!1!==(s=e.sent)){e.next=16;break}return e.abrupt("return");case 16:if(!(this.selectIndex>=s.length-1)){e.next=28;break}if(0!==s.length){e.next=27;break}if(!(this.state.page>1)){e.next=24;break}return this.selectIndex=0,this.state.page--,e.next=23,this.select(t,a);case 23:return e.abrupt("return",e.sent);case 24:return e.abrupt("return");case 27:this.selectIndex=s.length-1;case 28:for(this.selectIndex>=s.length-1&&(this.selectIndex=s.length-1),this.listIndex=(this.page-1)*this.size+this.selectIndex,i=this.state.list,i=[],c=0;c<s.length;c++)i.push({value:s[c],select:c===this.selectIndex});this.setState({key:a,list:i,showValue:s[this.selectIndex]},(function(){var e;null===(e=l.vlist.current)||void 0===e||e.forceUpdateGrid()}));case 34:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"selectItem",value:function(e,t){var a=this,n=this.state.list;n[this.selectIndex].select=!1,this.selectIndex=t.index,n[t.index].select=!0,this.listIndex=(this.page-1)*this.size+t.index,this.setState({list:n,showValue:n[t.index].value},(function(){var e;null===(e=a.vlist.current)||void 0===e||e.forceUpdateGrid()}))}},{key:"delRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==this.len){e.next=2;break}return e.abrupt("return",this.deleteKey());case 2:return e.next=4,re.update(this.type,this.key,this.listIndex,"@--LEMO-YXK--@");case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,re.delete(this.type,this.key,"@--LEMO-YXK--@");case 9:if(e.sent){e.next=12;break}return e.abrupt("return");case 12:this.listIndex===this.len-1&&(this.selectIndex--,this.listIndex--),this.select(this.type,this.key),r.a.success("\u5220\u9664\u6210\u529f!");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.insert(this.type,this.key,this.state.addRowValue);case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:this.state.addRowValue="",this.selectIndex++,this.listIndex++,this.select(this.type,this.key),r.a.success("\u6dfb\u52a0\u6210\u529f!"),this.closeAddRow();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPage",value:function(e){if(""===e)return this.setState({page:e});(e=parseInt(e)||1)<1||e>Math.ceil(this.len/this.size)||this.setState({page:e})}},{key:"save",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.update(this.type,this.key,this.listIndex,this.state.showValue);case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:(t=this.state.list)[this.selectIndex].value=this.state.showValue,this.setState({list:t},(function(){var e;null===(e=a.vlist.current)||void 0===e||e.forceUpdateGrid()})),r.a.success("\u4fdd\u5b58\u6210\u529f");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeView",value:function(e){switch(e){case"json":try{var t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t,null,4)})}catch(a){return}break;case"text":try{t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t)})}catch(a){return}}}},{key:"deleteKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.call(this.type,this.state.key,"remove");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:b.emit("deleteKey",this.key),this.parent.remove(this.key);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.key,a=this.state.key,this.key=this.state.key,e.next=5,re.rename(t,a);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",this.closeRename());case 8:b.emit("insertKey",a,!0),b.emit("deleteKey",t),this.closeRename(),this.parent.update(this.type,t,a);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeRename",value:function(){this.setState({rename:!1})}},{key:"openRename",value:function(){this.setState({rename:!0})}},{key:"closeAddRow",value:function(){this.setState({addRow:!1})}},{key:"openAddRow",value:function(){this.setState({addRow:!0})}},{key:"onChange",value:function(e){this.setState({showValue:e})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"list"},i.a.createElement($.a,{visible:this.state.rename,maskClosable:!1,closable:!1,onOk:function(){return e.renameKey()},onCancel:function(){return e.closeRename()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement($.a,{visible:this.state.addRow,maskClosable:!1,closable:!1,onOk:function(){return e.addRow()},onCancel:function(){return e.closeAddRow()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.addRowValue,onChange:function(t){return e.setState({addRowValue:t.target.value})}})),i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{addonBefore:this.type.toUpperCase(),addonAfter:"TTL: ".concat(this.ttl," SIZE: ").concat(this.len),value:this.state.key,spellCheck:!1}),i.a.createElement(g.a,{type:"default",onClick:function(){return e.openRename()}},"\u91cd\u547d\u540d"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.select(e.type,e.state.key)}},"\u5237\u65b0"),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.key," \u5417?"),onConfirm:function(){return e.deleteKey()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"dashed",danger:!0},"\u5220\u9664"))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"left"},i.a.createElement(P.a,{value:this.state.view,style:{width:100},onSelect:function(t){return e.changeView(t)}},i.a.createElement(pe,{key:"plain/text",value:"plain/text"},"plain/text"),i.a.createElement(pe,{key:"json",value:"json"},"json")),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.state.showValue," \u5417?"),onConfirm:function(){return e.delRow()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,null,"\u5220\u9664\u884c")),i.a.createElement(g.a,{onClick:function(){return e.openAddRow()}},"\u6dfb\u52a0\u884c")),i.a.createElement("div",{className:"right"}))),i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"left"},this.state.list.length>0?i.a.createElement(he.a,null,(function(t){var a=t.width,n=t.height;return i.a.createElement(he.b,{ref:e.vlist,height:n,width:a,overscanRowCount:20,rowCount:e.state.list.length,rowHeight:n/20,rowRenderer:e.renderItem,scrollToAlignment:"end",onScroll:e.onScroll})})):null),i.a.createElement("div",{className:"right"},i.a.createElement(de,{spellCheck:!1,value:this.state.showValue,onChange:function(t){return e.onChange(t.target.value)}}))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"left"},i.a.createElement(g.a,{onClick:this.prevPage},i.a.createElement(oe.a,null)),i.a.createElement(g.a,{onClick:this.nextPage},i.a.createElement(ue.a,null)),i.a.createElement(j.a,{onBlur:function(){return e.setPage(e.state.page||e.page)},value:this.state.page,onChange:function(t){return e.setPage(t.target.value)}}),i.a.createElement(g.a,{onClick:this.go},"GO")),i.a.createElement("div",{className:"right"},i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u4fdd\u5b58\u5417?",onConfirm:function(){return e.save()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"primary"},"\u4fdd\u5b58")))),i.a.createElement("div",{className:"bottom"})))}}]),t}(s.Component),ve=(a(601),j.a.TextArea),me=P.a.Option,ye=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).parent=void 0,a.state={key:"",showValue:"",showKey:"",list:[],page:1,rename:!1,addRow:!1,addRowValue:"",addRowKey:"",view:"\u663e\u793a\u683c\u5f0f"},a.type="",a.key="",a.ttl=-1,a.size=1e3,a.len=0,a.selectIndex=0,a.page=1,a.listIndex=0,a.allData=[],a.vlist=i.a.createRef(),a.onScroll=function(e){},a.renderItem=function(e){if(!(e.index>a.state.list.length-1))return a.state.list[e.index].select&&(e.style=Object.assign({background:"rgb(186, 231, 225)"},e.style)),i.a.createElement("div",{key:e.index,style:e.style,className:"list-item",onClick:function(t){return a.selectItem(t,e)}},i.a.createElement("div",{className:"i"},(a.page-1)*a.size+e.index+1),i.a.createElement("div",{className:"key"},a.state.list[e.index].key),i.a.createElement("div",{className:"value"},a.state.list[e.index].value))},a.prevPage=function(){a.state.page<=1||!a.state.page||(a.state.page--,a.setPage(a.state.page),a.go())},a.nextPage=function(){a.state.page>=Math.ceil(a.len/a.size)||!a.state.page||(a.state.page++,a.setPage(a.state.page),a.go())},a.go=function(){a.select(a.type,a.key)},a.type=a.props.type,a.key=a.props.keys,a.parent=a.props.parent,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.loadAllData(this.type,this.key)}},{key:"componentWillUnmount",value:function(){}},{key:"loadAllData",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r,s,i,c,l,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.allData=[],n=0,r={};case 3:return e.next=6,re.select(t,a,n);case 6:if(s=e.sent){e.next=9;break}return e.abrupt("return");case 9:for(n=parseInt(s[0]),i=0;i<s[1].length;i+=2)c=s[1][i],l=s[1][i+1],r[c]=l;if(0!==n){e.next=13;break}return e.abrupt("break",15);case 13:e.next=3;break;case 15:for(o in r)this.allData.push({key:o,value:r[o]});this.select(t,a);case 17:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"select",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r,s,i,c,l=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.type=t,this.key=a,e.next=4,re.call(t,a,"len");case 4:return n=e.sent,this.len=n,e.next=8,re.ttl(a);case 8:if(r=e.sent,this.ttl=r,this.page=this.state.page,s=this.allData.slice((this.page-1)*this.size,(this.page-1)*this.size+this.size),!(this.selectIndex>=s.length-1)){e.next=24;break}if(0!==s.length){e.next=23;break}if(!(this.state.page>1)){e.next=20;break}return this.selectIndex=0,this.state.page--,e.next=19,this.select(t,a);case 19:return e.abrupt("return",e.sent);case 20:return e.abrupt("return");case 23:this.selectIndex=s.length-1;case 24:for(this.selectIndex>=s.length-1&&(this.selectIndex=s.length-1),this.listIndex=(this.page-1)*this.size+this.selectIndex,i=this.state.list,i=[],c=0;c<s.length;c++)i.push({key:s[c].key,value:s[c].value,select:c===this.selectIndex});this.setState({key:a,list:i,showValue:s[this.selectIndex].value,showKey:s[this.selectIndex].key},(function(){var e;null===(e=l.vlist.current)||void 0===e||e.forceUpdateGrid()}));case 30:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"selectItem",value:function(e,t){var a=this,n=this.state.list;n[this.selectIndex].select=!1,this.selectIndex=t.index,n[t.index].select=!0,this.listIndex=(this.page-1)*this.size+t.index,this.setState({list:n,showValue:n[t.index].value,showKey:n[t.index].key},(function(){var e;null===(e=a.vlist.current)||void 0===e||e.forceUpdateGrid()}))}},{key:"delRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.list[this.selectIndex],1!==this.len){e.next=3;break}return e.abrupt("return",this.deleteKey());case 3:return e.next=5,re.delete(this.type,this.key,t.key);case 5:if(!1!==e.sent){e.next=8;break}return e.abrupt("return");case 8:this.allData.splice(this.listIndex,1),this.listIndex===this.len-1&&(this.selectIndex--,this.listIndex--),this.select(this.type,this.key),r.a.success("\u5220\u9664\u6210\u529f!");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.insert(this.type,this.key,this.state.addRowKey,this.state.addRowValue);case 2:if(!1!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:0===t&&this.filter(this.state.addRowKey),this.allData.splice(this.listIndex,0,{value:this.state.addRowValue,key:this.state.addRowKey}),this.state.addRowValue="",this.state.addRowKey="",this.selectIndex++,this.listIndex++,this.select(this.type,this.key),r.a.success("\u6dfb\u52a0\u6210\u529f!"),this.closeAddRow();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPage",value:function(e){if(""===e)return this.setState({page:e});(e=parseInt(e)||1)<1||e>Math.ceil(this.len/this.size)||this.setState({page:e})}},{key:"filter",value:function(e){for(var t=0;t<this.allData.length;t++){if(this.allData[t].key===e){this.allData.splice(t,1);break}}}},{key:"save",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.list[this.selectIndex],e.next=3,re.delete(this.type,this.key,t.key);case 3:if(!1!==e.sent){e.next=6;break}return e.abrupt("return");case 6:return this.allData.splice(this.listIndex,1),e.next=9,re.insert(this.type,this.key,this.state.showKey,this.state.showValue);case 9:if(!1!==(a=e.sent)){e.next=12;break}return e.abrupt("return");case 12:0===a&&this.filter(this.state.showKey),this.allData.splice(this.listIndex,0,{value:this.state.showValue,key:this.state.showKey}),this.select(this.type,this.key),r.a.success("\u4fdd\u5b58\u6210\u529f");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeView",value:function(e){switch(e){case"json":try{var t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t,null,4)})}catch(a){return}break;case"text":try{t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t)})}catch(a){return}}}},{key:"deleteKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.call(this.type,this.state.key,"remove");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:b.emit("deleteKey",this.key),this.parent.remove(this.key);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.key,a=this.state.key,this.key=this.state.key,e.next=5,re.rename(t,a);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",this.closeRename());case 8:b.emit("insertKey",a,!0),b.emit("deleteKey",t),this.closeRename(),this.parent.update(this.type,t,a);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeRename",value:function(){this.setState({rename:!1})}},{key:"openRename",value:function(){this.setState({rename:!0})}},{key:"closeAddRow",value:function(){this.setState({addRow:!1})}},{key:"openAddRow",value:function(){this.setState({addRow:!0})}},{key:"onChangeShowValue",value:function(e){this.setState({showValue:e})}},{key:"onChangeShowKey",value:function(e){this.setState({showKey:e})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"hash"},i.a.createElement($.a,{visible:this.state.rename,maskClosable:!1,closable:!1,onOk:function(){return e.renameKey()},onCancel:function(){return e.closeRename()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement($.a,{visible:this.state.addRow,maskClosable:!1,closable:!1,onOk:function(){return e.addRow()},onCancel:function(){return e.closeAddRow()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"add-row"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.addRowKey,addonBefore:"KEY",onChange:function(t){return e.setState({addRowKey:t.target.value})}}),i.a.createElement(j.a,{spellCheck:!1,value:this.state.addRowValue,addonBefore:"VALUE",onChange:function(t){return e.setState({addRowValue:t.target.value})}}))),i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{addonBefore:this.type.toUpperCase(),addonAfter:"TTL: ".concat(this.ttl," SIZE: ").concat(this.len),value:this.state.key,spellCheck:!1}),i.a.createElement(g.a,{type:"default",onClick:function(){return e.openRename()}},"\u91cd\u547d\u540d"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.loadAllData(e.type,e.state.key)}},"\u5237\u65b0"),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.key," \u5417?"),onConfirm:function(){return e.deleteKey()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"dashed",danger:!0},"\u5220\u9664"))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"left"},i.a.createElement(P.a,{value:this.state.view,style:{width:100},onSelect:function(t){return e.changeView(t)}},i.a.createElement(me,{key:"text",value:"text"},"text"),i.a.createElement(me,{key:"json",value:"json"},"json")),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.state.showKey," \u5417?"),onConfirm:function(){return e.delRow()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,null,"\u5220\u9664\u884c")),i.a.createElement(g.a,{onClick:function(){return e.openAddRow()}},"\u6dfb\u52a0\u884c")),i.a.createElement("div",{className:"right"}))),i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"left"},this.state.list.length>0?i.a.createElement(he.a,null,(function(t){var a=t.width,n=t.height;return i.a.createElement(he.b,{ref:e.vlist,height:n,width:a,overscanRowCount:20,rowCount:e.state.list.length,rowHeight:n/20,rowRenderer:e.renderItem,scrollToAlignment:"end",onScroll:e.onScroll})})):null),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{value:this.state.showKey,spellCheck:!1,onChange:function(t){return e.onChangeShowKey(t.target.value)}})),i.a.createElement("div",{className:"bottom"},i.a.createElement(ve,{spellCheck:!1,value:this.state.showValue,onChange:function(t){return e.onChangeShowValue(t.target.value)}})))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"left"},i.a.createElement(g.a,{onClick:this.prevPage},i.a.createElement(oe.a,null)),i.a.createElement(g.a,{onClick:this.nextPage},i.a.createElement(ue.a,null)),i.a.createElement(j.a,{onBlur:function(){return e.setPage(e.state.page||e.page)},value:this.state.page,onChange:function(t){return e.setPage(t.target.value)}}),i.a.createElement(g.a,{onClick:this.go},"GO")),i.a.createElement("div",{className:"right"},i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u4fdd\u5b58\u5417?",onConfirm:function(){return e.save()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"primary"},"\u4fdd\u5b58")))),i.a.createElement("div",{className:"bottom"})))}}]),t}(s.Component),ke=(a(602),j.a.TextArea),ge=P.a.Option,be=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).parent=void 0,a.state={key:"",showValue:"",list:[],page:1,rename:!1,addRow:!1,addRowValue:"",view:"\u663e\u793a\u683c\u5f0f"},a.type="",a.key="",a.ttl=-1,a.size=1e3,a.len=0,a.selectIndex=0,a.page=1,a.listIndex=0,a.allData=[],a.vlist=i.a.createRef(),a.onScroll=function(e){},a.renderItem=function(e){if(!(e.index>a.state.list.length-1))return a.state.list[e.index].select&&(e.style=Object.assign({background:"rgb(186, 231, 225)"},e.style)),i.a.createElement("div",{key:e.index,style:e.style,className:"list-item",onClick:function(t){return a.selectItem(t,e)}},i.a.createElement("div",{className:"key"},(a.page-1)*a.size+e.index+1),i.a.createElement("div",{className:"value"},a.state.list[e.index].value))},a.prevPage=function(){a.state.page<=1||!a.state.page||(a.state.page--,a.setPage(a.state.page),a.go())},a.nextPage=function(){a.state.page>=Math.ceil(a.len/a.size)||!a.state.page||(a.state.page++,a.setPage(a.state.page),a.go())},a.go=function(){a.select(a.type,a.key)},a.type=a.props.type,a.key=a.props.keys,a.parent=a.props.parent,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.loadAllData(this.type,this.key)}},{key:"componentWillUnmount",value:function(){}},{key:"loadAllData",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r,s,i,c,l;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.allData=[],n=0,r={};case 3:return e.next=6,re.select(t,a,n);case 6:if(s=e.sent){e.next=9;break}return e.abrupt("return");case 9:for(n=parseInt(s[0]),i=0;i<s[1].length;i++)c=s[1][i],r[c]=c;if(0!==n){e.next=13;break}return e.abrupt("break",15);case 13:e.next=3;break;case 15:for(l in r)this.allData.push(l);this.select(t,a);case 17:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"select",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r,s,i,c,l=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.type=t,this.key=a,e.next=4,re.call(t,a,"len");case 4:return n=e.sent,this.len=n,e.next=8,re.ttl(a);case 8:if(r=e.sent,this.ttl=r,this.page=this.state.page,s=this.allData.slice((this.page-1)*this.size,(this.page-1)*this.size+this.size),!(this.selectIndex>=s.length-1)){e.next=24;break}if(0!==s.length){e.next=23;break}if(!(this.state.page>1)){e.next=20;break}return this.selectIndex=0,this.state.page--,e.next=19,this.select(t,a);case 19:return e.abrupt("return",e.sent);case 20:return e.abrupt("return");case 23:this.selectIndex=s.length-1;case 24:for(this.selectIndex>=s.length-1&&(this.selectIndex=s.length-1),this.listIndex=(this.page-1)*this.size+this.selectIndex,i=this.state.list,i=[],c=0;c<s.length;c++)i.push({value:s[c],select:c===this.selectIndex});this.setState({key:a,list:i,showValue:s[this.selectIndex]},(function(){var e;null===(e=l.vlist.current)||void 0===e||e.forceUpdateGrid()}));case 30:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"selectItem",value:function(e,t){var a=this,n=this.state.list;n[this.selectIndex].select=!1,this.selectIndex=t.index,n[t.index].select=!0,this.listIndex=(this.page-1)*this.size+t.index,this.setState({list:n,showValue:n[t.index].value},(function(){var e;null===(e=a.vlist.current)||void 0===e||e.forceUpdateGrid()}))}},{key:"delRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.list[this.selectIndex],1!==this.len){e.next=3;break}return e.abrupt("return",this.deleteKey());case 3:return e.next=5,re.delete(this.type,this.key,t.value);case 5:if(!1!==e.sent){e.next=8;break}return e.abrupt("return");case 8:this.allData.splice(this.listIndex,1),this.listIndex===this.len-1&&(this.selectIndex--,this.listIndex--),this.select(this.type,this.key),r.a.success("\u5220\u9664\u6210\u529f!");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.insert(this.type,this.key,this.state.addRowValue);case 2:if(!1!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:0===t&&this.filter(this.state.addRowValue),this.allData.splice(this.listIndex,0,this.state.addRowValue),this.state.addRowValue="",this.selectIndex++,this.listIndex++,this.select(this.type,this.key),r.a.success("\u6dfb\u52a0\u6210\u529f!"),this.closeAddRow();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"filter",value:function(e){for(var t=0;t<this.allData.length;t++){if(this.allData[t]===e){this.allData.splice(t,1);break}}}},{key:"setPage",value:function(e){if(""===e)return this.setState({page:e});(e=parseInt(e)||1)<1||e>Math.ceil(this.len/this.size)||this.setState({page:e})}},{key:"save",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.list[this.selectIndex],e.next=3,re.delete(this.type,this.key,t.value);case 3:if(!1!==e.sent){e.next=6;break}return e.abrupt("return");case 6:return this.allData.splice(this.listIndex,1),e.next=9,re.insert(this.type,this.key,this.state.showValue);case 9:if(!1!==(a=e.sent)){e.next=12;break}return e.abrupt("return");case 12:0===a&&this.filter(this.state.showValue),this.allData.splice(this.listIndex,0,this.state.showValue),this.select(this.type,this.key),r.a.success("\u4fdd\u5b58\u6210\u529f");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeView",value:function(e){switch(e){case"json":try{var t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t,null,4)})}catch(a){return}break;case"text":try{t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t)})}catch(a){return}}}},{key:"deleteKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.call(this.type,this.state.key,"remove");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:b.emit("deleteKey",this.key),this.parent.remove(this.key);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.key,a=this.state.key,this.key=this.state.key,e.next=5,re.rename(t,a);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",this.closeRename());case 8:b.emit("insertKey",a,!0),b.emit("deleteKey",t),this.closeRename(),this.parent.update(this.type,t,a);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeRename",value:function(){this.setState({rename:!1})}},{key:"openRename",value:function(){this.setState({rename:!0})}},{key:"closeAddRow",value:function(){this.setState({addRow:!1})}},{key:"openAddRow",value:function(){this.setState({addRow:!0})}},{key:"onChange",value:function(e){this.setState({showValue:e})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"set"},i.a.createElement($.a,{visible:this.state.rename,maskClosable:!1,closable:!1,onOk:function(){return e.renameKey()},onCancel:function(){return e.closeRename()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement($.a,{visible:this.state.addRow,maskClosable:!1,closable:!1,onOk:function(){return e.addRow()},onCancel:function(){return e.closeAddRow()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.addRowValue,onChange:function(t){return e.setState({addRowValue:t.target.value})}})),i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{addonBefore:this.type.toUpperCase(),addonAfter:"TTL: ".concat(this.ttl," SIZE: ").concat(this.len),value:this.state.key,spellCheck:!1}),i.a.createElement(g.a,{type:"default",onClick:function(){return e.openRename()}},"\u91cd\u547d\u540d"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.loadAllData(e.type,e.state.key)}},"\u5237\u65b0"),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.key," \u5417?"),onConfirm:function(){return e.deleteKey()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"dashed",danger:!0},"\u5220\u9664"))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"left"},i.a.createElement(P.a,{value:this.state.view,style:{width:100},onSelect:function(t){return e.changeView(t)}},i.a.createElement(ge,{key:"plain/text",value:"plain/text"},"plain/text"),i.a.createElement(ge,{key:"json",value:"json"},"json")),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.state.showValue," \u5417?"),onConfirm:function(){return e.delRow()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,null,"\u5220\u9664\u884c")),i.a.createElement(g.a,{onClick:function(){return e.openAddRow()}},"\u6dfb\u52a0\u884c")),i.a.createElement("div",{className:"right"}))),i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"left"},this.state.list.length>0?i.a.createElement(he.a,null,(function(t){var a=t.width,n=t.height;return i.a.createElement(he.b,{ref:e.vlist,height:n,width:a,overscanRowCount:20,rowCount:e.state.list.length,rowHeight:n/20,rowRenderer:e.renderItem,scrollToAlignment:"end",onScroll:e.onScroll})})):null),i.a.createElement("div",{className:"right"},i.a.createElement(ke,{spellCheck:!1,value:this.state.showValue,onChange:function(t){return e.onChange(t.target.value)}}))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"left"},i.a.createElement(g.a,{onClick:this.prevPage},i.a.createElement(oe.a,null)),i.a.createElement(g.a,{onClick:this.nextPage},i.a.createElement(ue.a,null)),i.a.createElement(j.a,{onBlur:function(){return e.setPage(e.state.page||e.page)},value:this.state.page,onChange:function(t){return e.setPage(t.target.value)}}),i.a.createElement(g.a,{onClick:this.go},"GO")),i.a.createElement("div",{className:"right"},i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u4fdd\u5b58\u5417?",onConfirm:function(){return e.save()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"primary"},"\u4fdd\u5b58")))),i.a.createElement("div",{className:"bottom"})))}}]),t}(s.Component),xe=(a(603),j.a.TextArea),we=P.a.Option,Ee=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).parent=void 0,a.state={key:"",showValue:"",showKey:"",list:[],page:1,rename:!1,addRow:!1,addRowValue:"",addRowKey:"",view:"\u663e\u793a\u683c\u5f0f"},a.type="",a.key="",a.ttl=-1,a.size=1e3,a.len=0,a.selectIndex=0,a.page=1,a.listIndex=0,a.vlist=i.a.createRef(),a.onScroll=function(e){},a.renderItem=function(e){if(!(e.index>a.state.list.length-1))return a.state.list[e.index].select&&(e.style=Object.assign({background:"rgb(186, 231, 225)"},e.style)),i.a.createElement("div",{key:e.index,style:e.style,className:"list-item",onClick:function(t){return a.selectItem(t,e)}},i.a.createElement("div",{className:"i"},(a.page-1)*a.size+e.index+1),i.a.createElement("div",{className:"key"},a.state.list[e.index].key),i.a.createElement("div",{className:"value"},a.state.list[e.index].value))},a.prevPage=function(){a.state.page<=1||!a.state.page||(a.state.page--,a.setPage(a.state.page),a.go())},a.nextPage=function(){a.state.page>=Math.ceil(a.len/a.size)||!a.state.page||(a.state.page++,a.setPage(a.state.page),a.go())},a.go=function(){a.select(a.type,a.key)},a.type=a.props.type,a.key=a.props.keys,a.parent=a.props.parent,a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.select(this.type,this.key)}},{key:"componentWillUnmount",value:function(){}},{key:"select",value:function(){var e=Object(O.a)(S.a.mark((function e(t,a){var n,r,s,i,c,l,o,u=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.type=t,this.key=a,e.next=4,re.call(t,a,"len");case 4:return n=e.sent,this.len=n,e.next=8,re.ttl(a);case 8:return r=e.sent,this.ttl=r,this.page=this.state.page,e.next=13,re.select(t,a,this.state.page,this.size);case 13:if(!1!==(s=e.sent)){e.next=16;break}return e.abrupt("return");case 16:for(i=[],c=0;c<s.length;c+=2)i.push({value:s[c],key:s[c+1]});if(!(this.selectIndex>=i.length-1)){e.next=30;break}if(0!==i.length){e.next=29;break}if(!(this.state.page>1)){e.next=26;break}return this.selectIndex=0,this.state.page--,e.next=25,this.select(t,a);case 25:return e.abrupt("return",e.sent);case 26:return e.abrupt("return");case 29:this.selectIndex=i.length-1;case 30:for(this.listIndex=(this.page-1)*this.size+this.selectIndex,l=this.state.list,l=[],o=0;o<i.length;o++)l.push({value:i[o].value,key:i[o].key,select:o===this.selectIndex});this.setState({key:a,list:l,showValue:l[this.selectIndex].value,showKey:l[this.selectIndex].key},(function(){var e;null===(e=u.vlist.current)||void 0===e||e.forceUpdateGrid()}));case 35:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"selectItem",value:function(e,t){var a=this,n=this.state.list;n[this.selectIndex].select=!1,this.selectIndex=t.index,n[t.index].select=!0,this.listIndex=(this.page-1)*this.size+t.index,this.setState({list:n,showValue:n[t.index].value,showKey:n[t.index].key},(function(){var e;null===(e=a.vlist.current)||void 0===e||e.forceUpdateGrid()}))}},{key:"delRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state.list[this.selectIndex],1!==this.len){e.next=3;break}return e.abrupt("return",this.deleteKey());case 3:return e.next=5,re.delete(this.type,this.key,t.value);case 5:if(!1!==e.sent){e.next=8;break}return e.abrupt("return");case 8:this.listIndex===this.len-1&&(this.selectIndex--,this.listIndex--),this.select(this.type,this.key),r.a.success("\u5220\u9664\u6210\u529f!");case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addRow",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.addRowKey){e.next=2;break}return e.abrupt("return",r.a.error("\u8bf7\u586b\u5199\u5b8c\u6574!"));case 2:return e.next=4,re.insert(this.type,this.key,this.state.addRowKey,this.state.addRowValue);case 4:if(!1!==e.sent){e.next=7;break}return e.abrupt("return");case 7:this.state.addRowValue="",this.state.addRowKey="",this.selectIndex++,this.listIndex++,this.select(this.type,this.key),r.a.success("\u6dfb\u52a0\u6210\u529f!"),this.closeAddRow();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPage",value:function(e){if(""===e)return this.setState({page:e});(e=parseInt(e)||1)<1||e>Math.ceil(this.len/this.size)||this.setState({page:e})}},{key:"save",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.showKey){e.next=2;break}return e.abrupt("return",r.a.error("\u8bf7\u586b\u5199\u5b8c\u6574!"));case 2:return t=this.state.list[this.selectIndex],e.next=5,re.delete(this.type,this.key,t.value);case 5:if(!1!==e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,re.insert(this.type,this.key,this.state.showKey,this.state.showValue);case 10:if(!1!==e.sent){e.next=13;break}return e.abrupt("return");case 13:this.select(this.type,this.key),r.a.success("\u4fdd\u5b58\u6210\u529f");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeView",value:function(e){switch(e){case"json":try{var t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t,null,4)})}catch(a){return}break;case"text":try{t=JSON.parse(this.state.showValue);this.setState({view:e,showValue:JSON.stringify(t)})}catch(a){return}}}},{key:"deleteKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.call(this.type,this.state.key,"remove");case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:b.emit("deleteKey",this.key),this.parent.remove(this.key);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renameKey",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.key,a=this.state.key,this.key=this.state.key,e.next=5,re.rename(t,a);case 5:if(e.sent){e.next=8;break}return e.abrupt("return",this.closeRename());case 8:b.emit("insertKey",a,!0),b.emit("deleteKey",t),this.closeRename(),this.parent.update(this.type,t,a);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeRename",value:function(){this.setState({rename:!1})}},{key:"openRename",value:function(){this.setState({rename:!0})}},{key:"closeAddRow",value:function(){this.setState({addRow:!1})}},{key:"openAddRow",value:function(){this.setState({addRow:!0})}},{key:"onChangeShowValue",value:function(e){this.setState({showValue:e})}},{key:"onChangeShowKey",value:function(e){A.IsFloat(e)&&this.setState({showKey:e})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"zset"},i.a.createElement($.a,{visible:this.state.rename,maskClosable:!1,closable:!1,onOk:function(){return e.renameKey()},onCancel:function(){return e.closeRename()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement($.a,{visible:this.state.addRow,maskClosable:!1,closable:!1,onOk:function(){return e.addRow()},onCancel:function(){return e.closeAddRow()},width:300,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement("div",{className:"add-row"},i.a.createElement(j.a,{spellCheck:!1,value:this.state.addRowKey,addonBefore:"KEY",onChange:function(t){return A.IsFloat(t.target.value)&&e.setState({addRowKey:t.target.value})}}),i.a.createElement(j.a,{spellCheck:!1,value:this.state.addRowValue,addonBefore:"VALUE",onChange:function(t){return e.setState({addRowValue:t.target.value})}}))),i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{addonBefore:this.type.toUpperCase(),addonAfter:"TTL: ".concat(this.ttl," SIZE: ").concat(this.len),value:this.state.key,spellCheck:!1}),i.a.createElement(g.a,{type:"default",onClick:function(){return e.openRename()}},"\u91cd\u547d\u540d"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.select(e.type,e.state.key)}},"\u5237\u65b0"),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.key," \u5417?"),onConfirm:function(){return e.deleteKey()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"dashed",danger:!0},"\u5220\u9664"))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"left"},i.a.createElement(P.a,{value:this.state.view,style:{width:100},onSelect:function(t){return e.changeView(t)}},i.a.createElement(we,{key:"text",value:"text"},"text"),i.a.createElement(we,{key:"json",value:"json"},"json")),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(this.state.showKey," \u5417?"),onConfirm:function(){return e.delRow()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,null,"\u5220\u9664\u884c")),i.a.createElement(g.a,{onClick:function(){return e.openAddRow()}},"\u6dfb\u52a0\u884c")),i.a.createElement("div",{className:"right"}))),i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"left"},this.state.list.length>0?i.a.createElement(he.a,null,(function(t){var a=t.width,n=t.height;return i.a.createElement(he.b,{ref:e.vlist,height:n,width:a,overscanRowCount:20,rowCount:e.state.list.length,rowHeight:n/20,rowRenderer:e.renderItem,scrollToAlignment:"end",onScroll:e.onScroll})})):null),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{value:this.state.showKey,spellCheck:!1,onChange:function(t){return e.onChangeShowKey(t.target.value)}})),i.a.createElement("div",{className:"bottom"},i.a.createElement(xe,{spellCheck:!1,value:this.state.showValue,onChange:function(t){return e.onChangeShowValue(t.target.value)}})))),i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"top"},i.a.createElement("div",{className:"left"},i.a.createElement(g.a,{onClick:this.prevPage},i.a.createElement(oe.a,null)),i.a.createElement(g.a,{onClick:this.nextPage},i.a.createElement(ue.a,null)),i.a.createElement(j.a,{onBlur:function(){return e.setPage(e.state.page||e.page)},value:this.state.page,onChange:function(t){return e.setPage(t.target.value)}}),i.a.createElement(g.a,{onClick:this.go},"GO")),i.a.createElement("div",{className:"right"},i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u4fdd\u5b58\u5417?",onConfirm:function(){return e.save()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"primary"},"\u4fdd\u5b58")))),i.a.createElement("div",{className:"bottom"})))}}]),t}(s.Component),Ce=F.a.TabPane,Se=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={activeKey:"",panes:[]},a.serverName="",a.onChange=function(e){b.emit("activeKey",e,!0),a.setState({activeKey:e})},a.onEdit=function(e,t){"add"===t?a.add():a.remove(e)},a.add=function(){},a.remove=function(e){var t,n=a.state.activeKey;a.state.panes.forEach((function(a,n){a.key===e&&(t=n-1)}));var r=a.state.panes.filter((function(t){return t.key!==e}));r.length&&n===e&&(n=t>=0?r[t].key:r[0].key),a.setState({panes:r,activeKey:n}),0===r.length?b.emit("activeKey",n,!1):a.onChange(n)},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"createComponent",value:function(e,t){var a=null;switch(e){case"string":a=this.createString(e,t);break;case"list":a=this.createList(e,t);break;case"hash":a=this.createHash(e,t);break;case"zset":a=this.createZSet(e,t);break;case"set":a=this.createSet(e,t)}return a}},{key:"createString",value:function(e,t){return i.a.createElement(le,{parent:this,type:e,keys:t})}},{key:"createList",value:function(e,t){return i.a.createElement(fe,{parent:this,type:e,keys:t})}},{key:"createHash",value:function(e,t){return i.a.createElement(ye,{parent:this,type:e,keys:t})}},{key:"createSet",value:function(e,t){return i.a.createElement(be,{parent:this,type:e,keys:t})}},{key:"createZSet",value:function(e,t){return i.a.createElement(Ee,{parent:this,type:e,keys:t})}},{key:"reset",value:function(){this.serverName="",this.setState({activeKey:"",panes:[]})}},{key:"componentDidMount",value:function(){var e=this;b.add("selectKey",(function(t,a,n){if(e.serverName=t,e.state.panes.find((function(e){return e.key===n})))e.setState({activeKey:n});else{var r=e.state.panes,s=e.createComponent(a,n);r.push({title:n,content:s,key:n}),r.length>3&&r.shift(),e.setState({panes:r,activeKey:n})}})),b.add("resetPanel",(function(){e.reset()}))}},{key:"componentWillUnmount",value:function(){b.remove("selectKey"),b.remove("resetPanel")}},{key:"update",value:function(e,t,a){for(var n=0;n<this.state.panes.length;n++){var r=this.state.panes[n];r.key===t&&(r.title=a,r.key=a,r.content=this.createComponent(e,a))}this.setState({panes:this.state.panes,activeKey:a})}},{key:"render",value:function(){return i.a.createElement("div",{className:"panel"},i.a.createElement(F.a,{onChange:this.onChange,activeKey:this.state.activeKey,type:"editable-card",onEdit:this.onEdit,hideAdd:!0,style:{height:"100%",width:"100%"},tabBarStyle:{margin:0,minWidth:"200px"},destroyInactiveTabPane:!0,animated:!1,tabBarGutter:0},this.state.panes.map((function(e){return i.a.createElement(Ce,{style:{height:"100%",width:"100%",position:"relative"},tab:e.title,key:e.key,closable:e.closable},e.content)}))))}}]),t}(s.Component),Oe=(a(614),a(210)),Ne=(a(616),a(655)),je=Oe.a.Panel,Ie=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,configs:R.allConfig()},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"onClose",value:function(){this.setState({visible:!1})}},{key:"onOpen",value:function(){this.setState({visible:!0})}},{key:"componentDidMount",value:function(){var e=this;b.add("openServerList",(function(){return e.onOpen()})),b.add("addServer",(function(){return e.setState({configs:R.allConfig()})})),b.add("updateServer",(function(){return e.setState({configs:R.allConfig()})}))}},{key:"componentWillUnmount",value:function(){b.remove("openServerList")}},{key:"update",value:function(e){b.emit("update",e.name)}},{key:"connect",value:function(e){b.emit("connect",e.name,e.connectType),this.onClose()}},{key:"disconnect",value:function(e){this.onClose(),b.emit("disconnect",e.name),B.disconnect(e.name)}},{key:"delete",value:function(e){R.deleteConfig(e.name),this.setState({configs:R.allConfig()}),b.emit("delete",e.name),B.disconnect(e.name)}},{key:"setDefault",value:function(e){for(var t in this.state.configs)t!==e.name&&(this.state.configs[t].default=!1,R.setConfig(t,this.state.configs[t]));e.default=!e.default,R.setConfig(e.name,e),this.setState({configs:R.allConfig()})}},{key:"render",value:function(){var e=this,t=Object.values(this.state.configs);return i.a.createElement(N.a,{title:i.a.createElement("div",{className:"server-list-header"},i.a.createElement("div",{className:"left"},"\u670d\u52a1\u5668\u5217\u8868"),i.a.createElement("div",{className:"right"},i.a.createElement(g.a,{type:"default",onClick:function(){return $.a.confirm({content:"\u786e\u5b9a\u5bfc\u51fa\u6240\u6709\u914d\u7f6e?",okText:"\u522b\u5570\u55e6,\u5feb\u70b9!",cancelText:"\u6211\u518d\u60f3\u60f3.",onOk:function(){B.export("config.json",JSON.stringify(R.allConfig()))}})}},i.a.createElement(Ne.a,null)),i.a.createElement(g.a,{type:"danger",onClick:function(){return $.a.confirm({content:"\u786e\u5b9a\u6e05\u9664\u6240\u6709\u914d\u7f6e?",okText:"\u522b\u5570\u55e6,\u5feb\u70b9!",cancelText:"\u6211\u518d\u60f3\u60f3.",onOk:function(){R.deleteAllConfig(),e.setState({configs:{}})}})}},"\u6e05\u9664\u6240\u6709\u914d\u7f6e"))),placement:"right",closable:!1,onClose:function(){return e.onClose()},visible:this.state.visible,getContainer:!1,width:"400px",className:"server-list",destroyOnClose:!0},t.length>0?i.a.createElement(Oe.a,null,t.map((function(t){return i.a.createElement(je,{header:i.a.createElement("div",{className:"panel-title"},t.default?i.a.createElement("div",null,"".concat(t.name," (\u9ed8\u8ba4)")):i.a.createElement("div",null,t.name),i.a.createElement("div",null,i.a.createElement(g.a,{type:"link",onClick:function(){return e.connect(t)}},"\u8fde\u63a5"),i.a.createElement(g.a,{type:"link",danger:!0,onClick:function(){return e.disconnect(t)}},"\u65ad\u5f00"))),key:t.name},i.a.createElement("div",{className:"db-header",key:t.name},i.a.createElement("div",null,t.name),i.a.createElement("div",{className:"button"},i.a.createElement(g.a,{type:"link",onClick:function(){return e.setDefault(t)}},t.default?"\u53d6\u6d88\u9ed8\u8ba4":"\u8bbe\u4e3a\u9ed8\u8ba4"),i.a.createElement(g.a,{type:"link",onClick:function(){return e.update(t)}},"\u4fee\u6539"),i.a.createElement(X.a,{title:"\u786e\u5b9a\u8981\u5220\u9664 ".concat(t.name," \u5417?"),onConfirm:function(){return e.delete(t)},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",icon:i.a.createElement(se.a,{style:{color:"red"}})},i.a.createElement(g.a,{type:"link",danger:!0},"\u5220\u9664")))))}))):null)}}]),t}(s.Component),Re=a(138),Te=a.n(Re),Ke=(a(617),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,config:{},connectType:"normal",clusterHostInput:null},a.serverName="",a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"onOpen",value:function(){this.setState({visible:!0})}},{key:"onClose",value:function(){this.setState({visible:!1,clusterHostInput:null})}},{key:"componentDidMount",value:function(){var e=this;b.add("openUpdateServer",(function(t){e.serverName=t;var a=R.getConfig(t);a.cluster||(a.cluster=[]),e.setState({config:a},(function(){return e.setState({clusterHostInput:e.createCluster()})})),e.onOpen()}))}},{key:"componentWillUnmount",value:function(){b.remove("openUpdateServer")}},{key:"onChange",value:function(e,t){this.state.config[e]=t,this.setState({config:this.state.config,clusterHostInput:this.createCluster()})}},{key:"render",value:function(){var e=this;return i.a.createElement(Te.a,{destroyOnClose:!0,title:"\u4fee\u6539 ".concat(this.state.config.name," \u914d\u7f6e"),visible:this.state.visible,className:"update-server",closable:!1,maskClosable:!1,footer:null},i.a.createElement(I.a.Group,{value:this.state.connectType,onChange:function(t){return e.setState({connectType:t.target.value})}},i.a.createElement(I.a.Button,{value:"normal"},"Default"),i.a.createElement(I.a.Button,{value:"cluster"},"Cluster")),i.a.createElement("div",{className:"normal-form"},i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Name",placeholder:"127.0.0.1",value:this.state.config.name,onChange:function(t){return e.onChange("name",t.target.value)}}),"normal"===this.state.connectType?i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Host",placeholder:"127.0.0.1",value:this.state.config.host,onChange:function(t){return e.onChange("host",t.target.value)}}):i.a.createElement("div",{className:"add-input-box"},i.a.createElement("div",{className:"add"},i.a.createElement(g.a,{type:"dashed",onClick:function(){return e.addHost()}},"HOST")),i.a.createElement("div",{className:"input"},this.state.clusterHostInput)),"normal"===this.state.connectType?i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Port",placeholder:"6379",value:this.state.config.port,onChange:function(t){return e.onChange("port",t.target.value)}}):i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Master",placeholder:"master",value:this.state.config.master,onChange:function(t){return e.onChange("master",t.target.value)}}),i.a.createElement(j.a,{spellCheck:!1,addonBefore:"Pass",placeholder:"password",value:this.state.config.password,onChange:function(t){return e.onChange("password",t.target.value)}}),i.a.createElement("div",{className:"button-box"},i.a.createElement(g.a,{type:"primary",onClick:function(){return e.submit()}},"\u4fee\u6539"),i.a.createElement(g.a,{type:"primary",onClick:function(){return e.test()}},"\u6d4b\u8bd5"),i.a.createElement(g.a,{type:"default",onClick:function(){return e.onClose()}},"\u53d6\u6d88"))))}},{key:"createCluster",value:function(){var e=this;return this.state.config.cluster.map((function(t,a){return i.a.createElement(j.a,{spellCheck:!1,key:a,addonAfter:i.a.createElement(z.a,{onClick:function(){return e.removeHost(a)}}),className:"package-input",placeholder:"127.0.0.1:16379",value:e.state.config.cluster[a],onChange:function(t){var n=e.state.config;n.cluster[a]=t.target.value,e.setState({config:n,clusterHostInput:e.createCluster()})}})}))}},{key:"removeHost",value:function(e){this.state.config.cluster.splice(e,1),this.setState({clusterHostInput:this.createCluster()})}},{key:"addHost",value:function(){this.state.config.cluster.push(""),this.setState({clusterHostInput:this.createCluster()})}},{key:"test",value:function(){var e=Object(O.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.config.cluster=this.state.config.cluster.filter((function(e){return""!==e})),V.load(),e.next=4,B.register(this.state.connectType,this.state.config);case 4:return t=e.sent,V.close(),e.abrupt("return",A.Notification(t,"\u8fde\u63a5\u6210\u529f"));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){R.deleteConfig(this.serverName);var e=this.state.config;this.state.config.connectType=this.state.connectType,e.cluster=e.cluster.filter((function(e){return""!==e})),R.setConfig(this.state.config.name,this.state.config),r.a.success("\u4fee\u6539\u6210\u529f"),this.onClose(),b.emit("updateServer")}}]),t}(s.Component)),De=(a(641),a(300)),Ve=(a(643),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={progress:100},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillUnmount",value:function(){b.remove("progress")}},{key:"componentDidMount",value:function(){var e=this;b.add("progress",(function(t){return e.progress(t)}))}},{key:"progress",value:function(e){var t=this;0===e?setTimeout((function(){t.setState({progress:e})}),1e3):this.setState({progress:e})}},{key:"render",value:function(){return i.a.createElement(De.a,{strokeColor:{"0%":"#108ee9","100%":"#87d068"},style:{width:"100%",height:"1px"},showInfo:!1,strokeWidth:3,percent:this.state.progress,className:"progress"})}}]),t}(s.Component)),Ae=(a(644),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1,keyType:"string",key:"",k:"",v:""},a.config={},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"onClose",value:function(){this.setState({visible:!1,key:"",k:"",v:""})}},{key:"onOpen",value:function(){if(this.config=R.getCurrent(),!this.config.name)return r.a.error("\u8bf7\u8fde\u63a5\u670d\u52a1\u5668!"),this.onClose();this.setState({visible:!0})}},{key:"componentDidMount",value:function(){var e=this;b.add("addKey",(function(){return e.onOpen()}))}},{key:"componentWillUnmount",value:function(){b.remove("addKey")}},{key:"createNormal",value:function(){var e=this;return i.a.createElement("div",{className:"input-box-2"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{spellCheck:!1,addonBefore:"KEY",placeholder:"key",value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement("div",{className:"bottom"},i.a.createElement(j.a,{spellCheck:!1,addonBefore:"VALUE",placeholder:"value",value:this.state.v,onChange:function(t){return e.setState({v:t.target.value})}})))}},{key:"createSpecial",value:function(){var e=this;return i.a.createElement("div",{className:"input-box-3"},i.a.createElement("div",{className:"top"},i.a.createElement(j.a,{spellCheck:!1,addonBefore:"KEY",placeholder:"key",value:this.state.key,onChange:function(t){return e.setState({key:t.target.value})}})),i.a.createElement("div",{className:"bottom"},i.a.createElement(j.a,{spellCheck:!1,placeholder:"k",value:this.state.k,onChange:function(t){var a=t.target.value;"zset"===e.state.keyType?A.IsFloat(a)&&e.setState({k:a}):e.setState({k:a})}}),i.a.createElement(j.a,{spellCheck:!1,placeholder:"v",value:this.state.v,onChange:function(t){return e.setState({v:t.target.value})}})))}},{key:"createComponent",value:function(){switch(this.state.keyType){case"string":case"list":case"set":return this.createNormal();case"hash":case"zset":return this.createSpecial();default:return}}},{key:"render",value:function(){var e=this;return i.a.createElement($.a,{destroyOnClose:!0,title:"\u6dfb\u52a0KEY",visible:this.state.visible,className:"add-key",closable:!1,maskClosable:!1,footer:null},i.a.createElement("div",{className:"select-box"},i.a.createElement(I.a.Group,{value:this.state.keyType,onChange:function(t){return e.setState({keyType:t.target.value})}},i.a.createElement(I.a.Button,{value:"string"},"string"),i.a.createElement(I.a.Button,{value:"list"},"list"),i.a.createElement(I.a.Button,{value:"set"},"set"),i.a.createElement(I.a.Button,{value:"hash"},"hash"),i.a.createElement(I.a.Button,{value:"zset"},"zset"))),this.createComponent(),i.a.createElement("div",{className:"button-box"},i.a.createElement(g.a,{type:"primary",onClick:function(){return e.add()}},"\u786e\u5b9a"),i.a.createElement(g.a,{type:"default",onClick:function(){return e.onClose()}},"\u53d6\u6d88")))}},{key:"add",value:function(){var e=Object(O.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.state.key){e.next=2;break}return e.abrupt("return",r.a.error("\u8bf7\u586b\u5199\u5b8c\u6574!"));case 2:if(""!==this.state.v){e.next=4;break}return e.abrupt("return",r.a.error("\u8bf7\u586b\u5199\u5b8c\u6574!"));case 4:e.t0=this.state.keyType,e.next="string"===e.t0||"list"===e.t0||"set"===e.t0?7:"hash"===e.t0||"zset"===e.t0?14:23;break;case 7:return e.next=9,re.insert(this.state.keyType,this.state.key,this.state.v);case 9:if(e.sent){e.next=12;break}return e.abrupt("return");case 12:return r.a.success("\u6dfb\u52a0\u6210\u529f!"),e.abrupt("break",24);case 14:if(""!==this.state.k){e.next=16;break}return e.abrupt("return",r.a.error("\u8bf7\u586b\u5199\u5b8c\u6574!"));case 16:return e.next=18,re.insert(this.state.keyType,this.state.key,this.state.k,this.state.v);case 18:if(e.sent){e.next=21;break}return e.abrupt("return");case 21:return r.a.success("\u6dfb\u52a0\u6210\u529f!"),e.abrupt("break",24);case 23:return e.abrupt("return",r.a.error("\u4e0d\u652f\u6301\u7684\u7c7b\u578b!"));case 24:b.emit("insertKey",this.state.key),this.onClose();case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(s.Component)),Be=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"index"},i.a.createElement(Ae,null),i.a.createElement(U,null),i.a.createElement(Ie,null),i.a.createElement(Ke,null),i.a.createElement("div",{className:"header"},i.a.createElement(E,null)),i.a.createElement("div",{className:"content"},i.a.createElement(Y,null),i.a.createElement(Se,null)),i.a.createElement(Ve,null))}}]),t}(s.Component),ze=(a(645),a(656));var Ue=function(){return i.a.createElement("div",{className:"login"},i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"loading"},i.a.createElement(ze.a,{style:{fontSize:"2rem"}}),i.a.createElement("div",{className:"tips"},"\u6b63\u5728\u51c6\u5907..."))))},Pe=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).unlisten=void 0,a.state={start:!1},M.start((function(){return a.setState({start:!0})})),a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"change",value:function(e){return R.getStatus()?"#/login"===e.hash?window.location.hash="/index":void 0:window.location.hash="/login"}}]),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(k.a)(),a=t.location;this.change(a),this.unlisten=t.listen((function(t,a){e.change(t)}))}},{key:"componentWillUnmount",value:function(){M.close(),this.unlisten()}},{key:"render",value:function(){return this.state.start?i.a.createElement(m.a,null,i.a.createElement(y.d,null,i.a.createElement(y.b,{path:"/index",component:Be}),i.a.createElement(y.b,{path:"/login",component:Ue,exact:!0}),i.a.createElement(y.a,{from:"**",to:"/index"}))):null}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",u.a.defaults.baseURL="http://127.0.0.1:12388",u.a.defaults.timeout=5e3,u.a.interceptors.response.use((function(e){return e}),(function(e){return e})),r.a.config({maxCount:3}),n.a.config({duration:2,placement:"bottomRight"}),R.getUUID()||R.createUUID(),R.delDB(),R.delServerName(),R.delCurrent(),R.delStatus(),l.a.render(i.a.createElement(Pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[302,1,2]]]);
//# sourceMappingURL=main.d8282c38.chunk.js.map